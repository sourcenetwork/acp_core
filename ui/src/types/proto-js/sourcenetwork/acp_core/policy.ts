// Code generated by protoc-gen-ts_proto. DO NOT EDIT.
// versions:
//   protoc-gen-ts_proto  v2.6.1
//   protoc               unknown
// source: sourcenetwork/acp_core/policy.proto

/* eslint-disable */
import { type PolicySpecificationType } from "./specification";

export const protobufPackage = "sourcenetwork.acp_core";

/** PolicyEncodingType enumerates supported marshaling types for policies. */
export enum PolicyMarshalingType {
  /** UNKNOWN - Fallback value for a missing Marshaling Type */
  UNKNOWN = 0,
  /** YAML - YAML Marshaled Policy */
  YAML = 1,
  UNRECOGNIZED = -1,
}

/**
 * Policy represents an ACP module Policy definition.
 * Each Policy defines a set of high level rules over how the acces control system
 * should behave.
 */
export interface Policy {
  id: string;
  name: string;
  description: string;
  resources: Resource[];
  actorResource: ActorResource | undefined;
  attributes: { [key: string]: string };
  specificationType: PolicySpecificationType;
}

export interface Policy_AttributesEntry {
  key: string;
  value: string;
}

/**
 * Resource models a namespace for objects in a Policy.
 * Appications will have multiple entities which they must manage such as files or groups.
 * A Resource represents a set of entities of a certain type.
 */
export interface Resource {
  name: string;
  doc: string;
  permissions: Permission[];
  relations: Relation[];
  managementPermissions: ManagementPermission[];
  /**
   * owner models a special relation which is added to all resources.
   * It is used to represent the owner of some object in the system
   */
  owner: Relation | undefined;
}

export interface Relation {
  name: string;
  doc: string;
  /** list of relations managed by the current relation */
  manages: string[];
  /** value restriction types */
  vrTypes: Restriction[];
}

/**
 * Restriction models a specification which a Relationship's actor
 * should meet.
 */
export interface Restriction {
  /** resource_name scopes permissible actors resource */
  resourceName: string;
  /** relation_name scopes permissible actors relation */
  relationName: string;
}

/**
 * Permission models a special type of Relation which is evaluated at runtime.
 * A permission often maps to an operation defined for a resource which an actor may attempt.
 */
export interface Permission {
  name: string;
  doc: string;
  expression: string;
}

/** ActorResource represents a special Resource which is reserved for Policy actors. */
export interface ActorResource {
  name: string;
  doc: string;
  relations: Relation[];
}

export interface ManagementPermission {
  /** name matches the name of the underlying relation the management permission manages */
  name: string;
  /** expression is the permission expression derived from the manages directives from the policy definition */
  expression: string;
  /**
   * relations are the raw representation of the set of relations managed by
   * the current ManagementPermission
   */
  relations: string[];
}
